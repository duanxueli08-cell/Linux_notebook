## 初始化部署

配置顺序：

切换到 root 用户；使后续操作不受权限的限制；
开启 SSH 远程配置；后续步骤可以通过远程工具操作；
添加 PS1 变量 ；关爱眼睛，从你我做起！
设置软件源；为了将来更为了下一步。
下载常用的软件工具；
设置时区
设置时钟同步；


Ubuntu 系统在安装过程中通常不会设置 root 用户的密码，也不会启用 root 账户进行直接登录。默认情况下，Ubuntu 使用 sudo 命令来允许被授权的用户执行需要超级用户权限的操作。

```
sudo passwd root
```


### SSH 配置

- 允许远程登陆

```powershell
编辑 SSH 配置文件：
vim /etc/ssh/sshd_config

修改或添加以下参数：
# 允许 root 登录
PermitRootLogin yes
# 如果需要密码认证（可选）
PasswordAuthentication yes

重启 SSH 服务：
systemctl restart ssh

检验
# 检查配置语法
sudo sshd -t
# 查看服务状态
sudo systemctl status ssh
ss  -tunlp | grep 22
```

### PS1 变量

- 修改主机名称
- 修改IP地址
- 定义终端命令提示符的显示格式和颜色 ( 注意不要放置在shell语句中 )

```powershell
永久生效（添加到 ~/.bashrc）
# 格式：[用户名@主机名:/当前/完整/路径]$
cat >> /root/.bashrc <<eof
PS1='[\[\e[1;31m\]\u@\h\[\e[0m\]:\[\e[1;35m\]\w\[\e[0m\]]\$'
eof

重新加载配置文件
. ~/.bashrc

颜色代码：
\[\e[1;31m\] - 亮红色
\[\e[1;35m\] - 亮紫色
\[\e[0m\] - 重置颜色
内容变量：
\u - 当前用户名
\h - 主机名
\w - 当前工作目录的完整路径
\$ - 普通用户显示$，root用户显示#
```


### 永久修复 DNS

#### Netplan
（Ubuntu 24.04 默认）
编辑 Netplan 配置文件，添加 nameservers 字段，例如：

```
vi /etc/netplan/50-cloud-init.yaml 
network:
  version: 2
  ethernets:
    eth0:               # 替换为你的网卡名（用 ip a 查看）
      dhcp4: true
      nameservers:
        addresses: [8.8.8.8, 114.114.114.114]
```
然后应用配置：
```
sudo netplan apply
```


### 软件源

ubuntu

- **noble** - Ubuntu 24.04 LTS (Noble Numbat) - **最新 LTS 版本**

- **jammy** - Ubuntu 22.04 LTS (Jammy Jellyfish) - 当前稳定 LTS 版本

- **focal** - Ubuntu 20.04 LTS (Focal Fossa) - 较旧 LTS 版本

```powershell
# 显示所有已配置的软件源
apt policy
# 查看主软件源配置
cat /etc/apt/sources.list
# 查看所有额外的软件源文件
ls -la /etc/apt/sources.list.d/
# 查看某个具体源文件的内容 (也可能是别的名字！)
cat /etc/apt/sources.list.d/ubuntu.sources

查看当前系统版本
cat /etc/os-release
```

编辑软件源的配置文件

```powershell
# 将原来的软件源文件改名为ubuntu.sources.bak，新建一个ubuntu.sources文件
cat > /etc/apt/sources.list.d/ubuntu.sources << eof
Types: deb
URIs: https://mirrors.aliyun.com/ubuntu/
Suites: noble noble-updates noble-backports
Components: main restricted universe multiverse
Signed-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg

Types: deb
URIs: https://mirrors.aliyun.com/ubuntu/
Suites: noble-security
Components: main restricted universe multiverse
Signed-By: /usr/share/keyrings/ubuntu-archive-keyring.gpg
eof

或者修改关键点：
cat /etc/os-release    # 查看系统版本信息
sed -i  "s@URIs:.*@URIs: http://mirrors.aliyun.com/ubuntu/@" "/etc/apt/sources.list.d/ubuntu.sources"
sed -i  "s@$VERSION_CODENAME@noble@g" "/etc/apt/sources.list.d/ubuntu.sources"

# 更新软件包列表
apt update
# 检查下载速度
sudo apt install -y wget curl
# 查看可更新软件包
apt list --upgradable
```

### 常用软件包下载

  - ```powershell
    # 查询软件包信息（包括未安装的）
    dpkg -l | grep 软件包名称
    
    # 搜索包含关键字的软件包
    apt search 软件包名称
    
    # 查看软件包是否存在及详细信息
    apt show 软件包名称
    
    # 检查软件包是否在仓库中
    apt list 软件包名称
    
    # 模拟安装，查看依赖和是否可用
    apt install -s 软件包名称
    ```

```powershell
下载
apt install -y \
  wget curl tree bash-completion \
  network-manager net-tools iputils-ping \
  vim unzip

apt install -y dnsutils

网络工具
wget - 命令行下载工具
curl - 网络数据传输工具
nmcli - NetworkManager 命令行工具
net-tools - 传统网络工具（ifconfig、netstat等）
iputils-ping - ping 命令

系统工具
tree - 树状显示目录结构
bash-completion - Bash 自动补全
vim - 文本编辑器
unzip - ZIP 压缩包解压
```



### 设置时区

```powershell
# 设置时区为上海
sudo timedatectl set-timezone Asia/Shanghai
# 验证设置
timedatectl
```


### **同步系统时间** 

```powershell
# 方法一：使用 timedatectl
# 安装 NTP 服务（如果未安装）
sudo apt install systemd-timesyncd
# 启用并启动时间同步
sudo timedatectl set-ntp true
# 检查状态
timedatectl status

#方法二：使用 ntpdate 强制同步（推荐）
# 安装 ntpdate
sudo apt install ntpdate
# 强制同步时间（使用阿里云NTP服务器）
sudo ntpdate -u ntp.aliyun.com
```


```

查看当前系统架构

```powershell
uname -m
dpkg --print-architecture
```


### 最后别忘了做快照哦！
