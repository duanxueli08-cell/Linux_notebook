
### 背景：

已经打开了 Windows 更新策略，同时对 Windows 更新进行了大量的时间延迟更新；
包都已经下载好了！




### Gemini_Pro 提供的操作步骤：


##### 必须注意安装顺序：

先装那 4 个依赖库（Framework/Runtime），最后装商店主程序（WindowsStore），否则会报“缺少依赖”的错误。

##### 操作步骤

**第一步：在当前文件夹打开 PowerShell**

1. 打开你存放这 5 个安装包的文件夹。
2. 点击文件夹左上角的 **“文件”** -> **“打开 Windows PowerShell”** -> **“以管理员身份打开 Windows PowerShell”**。
* 或者：在地址栏输入 `powershell`，然后按下 `Ctrl + Shift + Enter`（以管理员身份运行）。



**第二步：按顺序执行安装命令**

请在 PowerShell 窗口中，**依次**复制并运行以下命令（利用通配符匹配文件名，防止输错）：

**1. 安装 VCLibs 运行库（最基础的依赖）：**

```powershell
Add-AppxPackage -Path .\Microsoft.VCLibs*.appx

```

**2. 安装 .NET Native Framework：**

```powershell
Add-AppxPackage -Path .\Microsoft.NET.Native.Framework*.appx

```

**3. 安装 .NET Native Runtime：**

```PowerShell
Add-AppxPackage -Path .\Microsoft.NET.Native.Runtime*.appx
```

**4. 安装 UI Xaml 库（UI 渲染框架）：**

```powershell
Add-AppxPackage -Path .\Microsoft.UI.Xaml*.appx

```

**5. 最后，安装微软商店主程序：**

```powershell
Add-AppxPackage -Path .\Microsoft.WindowsStore*.Msixbundle

```

---

##### 如果觉得一条条敲太麻烦（运维偷懒法）

你也可以直接运行下面这条“一键遍历安装”命令，它会尝试安装文件夹下所有的包。如果有依赖报错，多运行一次通常就解决了：

```powershell
Get-ChildItem *.appx, *.msixbundle | ForEach-Object { Add-AppxPackage -Path $_.FullName }

```

##### 验证与收尾

1. 等待命令跑完，只要没有红字报错，就是安装成功了。
2. 按下 `Win` 键，你应该能在开始菜单里看到 **Microsoft Store** 的图标了。
3. **重要提示：** 刚安装好的商店第一次打开可能会闪退或者转圈（因为 LTSC 缺很多后台服务），请耐心等待它自动联网更新自己，或者**重启一次电脑**让服务生效。

按照这个流程，你的 LTSC 系统就能拥有微软商店了，且配合我们之前的“5年不更新”大法，既稳如老狗，又能下软件。