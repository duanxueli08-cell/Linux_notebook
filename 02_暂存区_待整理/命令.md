### å‘½ä»¤

##### ç½‘ç»œ

```powershell
å¼€å¯ IP è½¬å‘(ä¸´æ—¶ç”Ÿæ•ˆ)
echo 1 > /proc/sys/net/ipv4/ip_forward
# æŸ¥çœ‹æ˜¯å¦å¼€å¯ï¼šsysctl net.ipv4.ip_forward

å…è®¸rootç”¨æˆ·è¿œç¨‹ç™»å½•
vi /etc/ssh/sshd_config
	PermitRootLogin yes
sudo systemctl restart ssh

æ¿€æ´»ç½‘å¡
ip link set dev ens0 up

æ‰‹å·¥é…ç½®é™æ€è·¯ç”±ï¼ˆä¸´æ—¶ï¼‰ï¼š
ip route add 192.168.50.0/24 via 192.168.1.1 dev eth0

ä¸´æ—¶åˆ é™¤ï¼ˆç«‹å³ç”Ÿæ•ˆï¼Œé‡å¯åæ¶ˆå¤±ï¼‰ï¼š
ip route del 192.168.50.0/24
æŒ‡å®šç½‘å¡åˆ é™¤è·¯ç”±ï¼š
ip route del 192.168.50.0/24 via 192.168.1.1 dev eth0

é‡æ–°åŠ è½½ç½‘ç»œï¼ˆå‘½ä»¤è¡Œæ·»åŠ /åˆ é™¤ â†’ ç«‹å³ç”Ÿæ•ˆï¼Œä¸éœ€è¦åŠ è½½ã€‚ï¼‰
Rockyï¼šsystemctl restart NetworkManager	|	nmcli connection reload
Ubuntuï¼šnetplan apply

æŸ¥çœ‹ç½‘å¡ä¿¡æ¯ï¼š
ip link

æŸ¥çœ‹è·¯ç”±è¡¨å’ŒMACåœ°å€è¡¨
ip route	&	arp -n

Rockyé˜²ç«å¢™ï¼š
æŸ¥çœ‹ï¼šsystemctl status firewalld
é‡å¯ï¼šsystemctl restart firewalld
ä¸´æ—¶æš‚åœï¼šsystemctl stop firewalld
ç¦æ­¢å¼€æœºè‡ªå¯åŠ¨ï¼šsystemctl disable firewalld

Ubuntué˜²ç«å¢™ï¼š
æŸ¥çœ‹ï¼šufw status
é‡å¯ï¼šufw disable	&&	ufw enable


```

##### ç”¨æˆ·ç®¡ç†+æ–‡ä»¶ç®¡ç†

```powershell
chmod    666    hello		# ä¿®æ”¹æ–‡ä»¶å±æ€§
chmod    o+x    hello		# æ‰€å±ä¸»uã€æ‰€å±ç»„gã€å…¶ä»–äººoã€è¯»rã€å†™wã€æ‰§è¡Œx
chown    duan:duan   hello		# ä¿®æ”¹æ–‡ä»¶æ‰€å±ä¸»ä¸æ‰€å±ç»„

ls -l	# åˆ—å‡ºæ–‡ä»¶å±æ€§ï¼šå¤§å°ã€æƒé™ã€ä¿®æ”¹æ—¶é—´ã€‚
file	# æŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚æ–‡æœ¬ã€äºŒè¿›åˆ¶ã€è„šæœ¬ç­‰ã€‚
stat	# æ›´è¯¦ç»†çš„æ–‡ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¿é—®ã€ä¿®æ”¹ã€åˆ›å»ºæ—¶é—´ã€‚
du -h	# åªæ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹ä¸€çº§å­ç›®å½•çš„å¤§å°ï¼ˆä¸ä¼šé€’å½’åˆ°æ›´æ·±å±‚ï¼‰ã€‚
catï¼ˆä¸€æ¬¡æ€§è¾“å‡ºæ•´ä¸ªæ–‡ä»¶ï¼‰					moreï¼ˆåˆ†é¡µæŸ¥çœ‹ï¼Œåªèƒ½å‘ä¸‹ç¿»ï¼‰
headï¼ˆæŸ¥çœ‹æ–‡ä»¶å‰ n è¡Œï¼Œé»˜è®¤ 10 è¡Œï¼‰			tailï¼ˆæŸ¥çœ‹æ–‡ä»¶å n è¡Œï¼Œé»˜è®¤ 10 è¡Œï¼‰

useradd -r -s /usr/sbin/nologin nginx
# åˆ›å»ºä¸€ä¸ªç³»ç»Ÿç”¨æˆ·å¯¹nginxè¿›è¡Œç®¡ç†ï¼›-rè¡¨ç¤ºåˆ›å»ºçš„æ˜¯ç³»ç»Ÿç”¨æˆ·ï¼›
# ä¸åŠ -sï¼Œç³»ç»Ÿä¼šä½¿ç”¨é»˜è®¤ shellï¼ˆé€šå¸¸åœ¨ /etc/default/useradd æˆ– /etc/login.defs é‡Œå®šä¹‰ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æ˜¯ /bin/bashï¼‰ã€‚
# å¯é€‰å€¼å¸¸è§æœ‰ï¼š
    /bin/bash â†’ äº¤äº’å¼ shellï¼Œå¯æ­£å¸¸ç™»å½•ä½¿ç”¨ã€‚
    /bin/sh â†’ ç²¾ç®€ç‰ˆ shellã€‚
    /sbin/nologin æˆ– /usr/sbin/nologin â†’ ç¦æ­¢ç™»å½•ã€‚
    /bin/false â†’ ç«‹å³é€€å‡ºï¼Œç›¸å½“äºæ›´â€œç¡¬â€çš„ç¦æ­¢ç™»å½•ã€‚
```



##### Nginx

```powershell
æŸ¥çœ‹çŠ¶æ€ï¼š		systemctl  status  nginx
å¼€å¯nginxæœåŠ¡ï¼š	systemctl  start   nginx
é‡æ–°åŠ è½½nginxï¼š	systemctl  reload  nginx
å…³é—­nginxè‡ªå¯åŠ¨:	systemctl  disable nginx
```



##### è½¯ä»¶åŒ…

| æ“ä½œ             | Debian/Ubuntu      | Rocky Linux/RHEL                      |
| :--------------- | :----------------- | :------------------------------------ |
| **æ™®é€šå¸è½½**     | `apt remove nginx` | `dnf remove nginx`                    |
| **å½»åº•åˆ é™¤**     | `apt purge nginx`  | `dnf remove nginx` + æ‰‹åŠ¨åˆ é™¤é…ç½®æ–‡ä»¶ |
| **è‡ªåŠ¨æ¸…ç†ä¾èµ–** | `apt autoremove`   | `dnf autoremove`                      |

```powershell
Rocky-å½»åº•åˆ é™¤ï¼ˆåŒ…æ‹¬ä¾èµ–å’Œé…ç½®æ–‡ä»¶ï¼‰ï¼šdnf autoremove <åŒ…å>
Rocky-æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼š		dnf list installed
Ubuntu-åˆ é™¤è½¯ä»¶åŒ…å¹¶æ¸…ç†é…ç½®æ–‡ä»¶ï¼š	apt purge <åŒ…å>
Ubuntu-æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ…ï¼š			dpkg -l
æ¸…é™¤ä¾èµ–ç¯å¢ƒå’Œé…ç½®æ–‡ä»¶ï¼š		apt autoremove	|	dnf autoremove

apt remove --purge default-jdk		# remove å¸è½½è½¯ä»¶åŒ…ï¼›--purge ä¼šåŒæ—¶ç§»é™¤é…ç½®æ–‡ä»¶ã€‚
apt autoremove --purge				# autoremove ä¼šæ¸…ç†ä¸å†ä½¿ç”¨çš„ä¾èµ–åº“ã€‚

# 1. ç§»é™¤æ— ç”¨ä¾èµ–
sudo dnf autoremove -y

# 2. æ¸…ç†æ‰€æœ‰ç¼“å­˜
sudo dnf clean all	

æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…
dnf list installed

ubuntuçš„è½¯ä»¶æºä»“åº“è·¯å¾„		/etc/apt/sources.list   åŠ    /etc/apt/sources.list.d/ ç›®å½•
è½¯ä»¶åŒ…ç¼“å­˜å’ŒçŠ¶æ€æ–‡ä»¶			/var/lib/apt/lists/
```



##### æŸ¥çœ‹

###### å¸¸ç”¨è½¯ä»¶çš„é»˜è®¤é…ç½®è·¯å¾„:

```powershell
è½¯ä»¶				é…ç½®æ–‡ä»¶è·¯å¾„
SSH				/etc/ssh/sshd_config
Apache			/etc/httpd/conf/httpd.conf
Nginx			/etc/nginx/nginx.conf
MySQL/MariaDB	/etc/my.cnf
PostgreSQL		/var/lib/pgsql/data/postgresql.conf
Docker			/etc/docker/daemon.json
```

###### æŸ¥çœ‹æœåŠ¡é»˜è®¤é…ç½®è·¯å¾„

```powershell
# æŸ¥çœ‹æœåŠ¡çš„å¯åŠ¨è„šæœ¬ï¼Œå…¶ä¸­é€šå¸¸åŒ…å«é…ç½®è·¯å¾„
systemctl cat æœåŠ¡å
```

###### ä½¿ç”¨åŒ…ç®¡ç†å™¨æŸ¥æ‰¾é…ç½®æ–‡ä»¶

```powershell
# æŸ¥çœ‹å·²å®‰è£…è½¯ä»¶åŒ…çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬é…ç½®æ–‡ä»¶ï¼‰
rpm -qc è½¯ä»¶åŒ…åç§°
```





##### Mysql


```powershell
å®‰è£…
dnf list mysql mysql-server
getent passwd mysql			# æŸ¥çœ‹è‡ªåŠ¨åˆ›å»ºè´¦æˆ·
mysql -u root -p -P 3360	# æŒ‡å®šç”¨æˆ·ï¼›æŒ‡å®šå¯†ç ï¼šæŒ‡å®šç«¯å£å·ï¼›
\s		# åƒæ˜¯å½“å‰MysqlæœåŠ¡å™¨ä¼šè¯çŠ¶æ€çš„å¿«æ·æŒ‡ä»¤ï¼›

```

```powershell
ä¸€ä¸ªMySQLå®ä¾‹å¯ä»¥åŒ…å«å¤šä¸ªæ•°æ®åº“ï¼›
æ¯ä¸ªæ•°æ®åº“å¯ä»¥åŒ…å«å¤šå¼ æ•°æ®è¡¨ï¼›
è¡¨æ˜¯å…·ä½“å­˜å‚¨æ•°æ®çš„è½½ä½“ï¼›

æŸ¥çœ‹æ•°æ®åº“
SHOW DATABASES;               -- æŸ¥çœ‹å½“å‰ MySQL å®ä¾‹ä¸­çš„æ‰€æœ‰æ•°æ®åº“
SHOW CREATE DATABASE shop; -- æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„åˆ›å»ºè¯­å¥ï¼ˆåŒ…å«å­—ç¬¦é›†å’Œæ ¡å¯¹è§„åˆ™ï¼Œæ˜¯æ’æŸ¥å­—ç¬¦é›†æˆ–è¿ç§»ç¯å¢ƒæ—¶å¸¸ç”¨çš„å‘½ä»¤ï¼‰
åˆ‡æ¢æ•°æ®åº“
USE shop;        	          -- åˆ‡æ¢å½“å‰ä¼šè¯ä½¿ç”¨çš„æ•°æ®åº“
SELECT DATABASE();            -- æŸ¥çœ‹å½“å‰ä½¿ç”¨çš„æ•°æ®åº“
åˆ›å»ºæ•°æ®åº“ï¼ˆæ¨è utf8mb4ï¼‰
CREATE DATABASE shop;         -- åˆ›å»ºä¸€ä¸ªæ•°æ®åº“
# MySQL 8.0+ é»˜è®¤ï¼šutf8mb4 + utf8mb4_0900_ai_ci
	CREATE DATABASE shop CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
	# -- æ˜¾å¼æŒ‡å®šå­—ç¬¦é›†å’Œæ’åºè§„åˆ™ï¼ˆé€šç”¨å…¼å®¹ï¼‰
	CREATE DATABASE IF NOT EXISTS db_name CHARACTER SET utf8mb4;
	# -- é¿å…é‡å¤åˆ›å»ºæ—¶æŠ¥é”™
åˆ é™¤æ•°æ®åº“ï¼ˆåˆ é™¤å‰åŠ¡å¿…å¤‡ä»½ï¼‰
DROP DATABASE IF EXISTS db_name;
# åˆ é™¤å‰ç¡®ä¿å½“å‰ç”¨æˆ·æ‹¥æœ‰ DROP æƒé™ï¼šSHOW GRANTS FOR 'user'@'%';


æŸ¥çœ‹æ•°æ®è¡¨
SHOW TABLES;				  -- æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨
DESC products;				  -- æŸ¥çœ‹æ•°æ®è¡¨çš„åˆ—ç»“æ„
SHOW TABLES FROM shop;		  -- æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®è¡¨
```

> **ç»Ÿä¸€ä½¿ç”¨ `utf8mb4`**ï¼šé¿å…ä»¥åæ”¯æŒè¡¨æƒ…ç¬¦å·æˆ–å¤šè¯­è¨€æ—¶å‡ºç°é—®é¢˜ã€‚
>
> **æ˜ç¡®æŒ‡å®š `COLLATE`**ï¼š
>
> - `utf8mb4_general_ci`ï¼šæ¯”è¾ƒå®½æ¾ï¼Œé€Ÿåº¦ç¨å¿«ã€‚
> - `utf8mb4_unicode_ci`ï¼šæ¯”è¾ƒä¸¥æ ¼ï¼Œé€‚åˆå¤šè¯­è¨€ã€‚
>
> **å‘½åè§„èŒƒ**ï¼š
>
> - é¿å…ä½¿ç”¨å¤§å†™æˆ–ç‰¹æ®Šå­—ç¬¦ã€‚
>
> åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œ**ä¿®æ”¹æ•°æ®åº“å­—ç¬¦é›†ç¡®å®å¾ˆå°‘å‘ç”Ÿ**ã€‚æ›´å¤šæƒ…å†µä¸‹ä¼šé€šè¿‡**å‰æœŸè®¾è®¡**å’Œ**è¿ç§»æ–°åº“**æ¥å¤„ç†å­—ç¬¦é›†é—®é¢˜ï¼Œè€Œä¸æ˜¯åœ¨çº¿ç›´æ¥ä¿®æ”¹ã€‚



##### Ansible

###### ansible palybook ç¤ºä¾‹ä¸€

```powershell
vi adsent-nginx.yml 

---
- name: å¸è½½nginx
  hosts: 10.0.0.12
  remote_user: root
  gather_facts: yes
  vars: 
    nginx_packate_state: absent

  tasks:
    - name: åœæ­¢nginxæœåŠ¡
      ansible.builtin.service:
        name: nginx
        state: stopped
      ignore_errors: yes

    - name: å¸è½½ Nginx è½¯ä»¶åŒ…å¹¶ç§»é™¤ä¸å†éœ€è¦çš„ä¾èµ–åŒ… (RedHat/CentOS ç³»åˆ—)
      ansible.builtin.package:
        name: nginx
        state: absent
        autoremove: yes

    - name: åˆ é™¤ Nginx é…ç½®ç›®å½•
      ansible.builtin.file:
        path: /etc/nginx
        state: absent  # åˆ é™¤ç›®å½•
      ignore_errors: yes

    - name: åˆ é™¤ Nginx æ—¥å¿—ç›®å½•
      ansible.builtin.file:
        path: /var/log/nginx
        state: absent
      ignore_errors: yes
        
##########################

vi present-nginx.yml 

---

- name: åœ¨rocky Linuxå®‰è£…nginx
  hosts: 10.0.0.11
  become: yes
  gather_facts: yes

  tasks:
  - name: æ›´æ–°ç¼“å­˜å¹¶å®‰è£… nginx
    ansible.builtin.package:
      name: nginx
#      update_cache: yes
      state: present

  - name: ç¡®å®š nginx æœåŠ¡å·²ç»å¯åŠ¨è¿è¡Œ
    ansible.builtin.service:
#      name: nginx
#      state: started
#      enabled: yes


```



##### Nmap-Zenmap

```powershell
å¿«é€Ÿæ‰«æ
nmap -sn -PE --min-hostgroup 1024 --min-parallelism 100 172.18.0.0/16
-PE: ICMP echoè¯·æ±‚
-sn: åªè¿›è¡Œä¸»æœºå‘ç°ï¼Œä¸æ‰«æç«¯å£
--min-hostgroup 1024: å¤§ä¸»æœºç»„æé«˜æ•ˆç‡
--min-parallelism 100: å¢åŠ å¹¶è¡Œæ¢æµ‹æ•°
```






##### vimç¼–è¾‘å™¨

```powershell
	d$æˆ–è€…D #ä»å…‰æ ‡åˆ é™¤åˆ°æœ¬è¡Œæœ«å°¾ã€‚å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ä¹Ÿä¼šåˆ é™¤ã€‚
	dd #åˆ é™¤æ•´è¡Œã€‚2ddåˆ é™¤2è¡Œ
	yy #å¤åˆ¶ï¼›3yyå°±æ˜¯å¤åˆ¶ä¸‰è¡Œï¼›
	dG #åˆ é™¤å…‰æ ‡å®šä½è‡³æ–‡ç« ç»“æŸï¼›
	u   #æ’¤é”€æœ€åä¸€ä¸ªå‘½ä»¤ã€‚
	o  #å…‰æ ‡ä¸‹æ–¹æ–°å¼€ä¸€è¡Œå¹¶è¿›å…¥æ’å…¥æ¨¡å¼
	p   #ç²˜è´´åˆ°å…‰æ ‡çš„ä¸‹ä¸€è¡Œã€‚
v è¿›å…¥å¯è§†åŒ–è§†å›¾ï¼Œç§»åŠ¨å…‰æ ‡é€‰ä¸­ï¼ŒyæŠ½å–é€‰ä¸­å†…å®¹ï¼Œescé€€å‡ºï¼Œpç›´æ¥æœ¬è¡Œç²˜è´´ã€‚
SHIFT + V  æ‰¹é‡é€‰æ‹©æ–‡æœ¬å­—ç¬¦ä¸²
set nu æ˜¾ç¤ºæ¯ä¸€è¡Œçš„è¡Œå·

:%s/3306/3307/g		# %--ä½œç”¨èŒƒå›´æ˜¯æ•´ä¸ªæ–‡ä»¶ï¼ˆä¹Ÿå¯ç”¨ 1,$ï¼‰ï¼›s--æ‰§è¡Œæ›¿æ¢ï¼›
					# g--å…¨å±€æ›¿æ¢ä¸€è¡Œä¸­å‡ºç°çš„æ‰€æœ‰åŒ¹é…é¡¹ï¼Œè€Œä¸æ˜¯åªæ›¿æ¢é¦–ä¸ªåŒ¹é…ï¼›
```



##### å¸¸ç”¨æŸ¥çœ‹å‘½ä»¤

```powershell
cat /etc/os-release		# æŸ¥çœ‹å½“å‰å‘è¡Œç‰ˆåç§°å’Œç‰ˆæœ¬ï¼ˆé€šç”¨ï¼‰
hostnamectl		# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼ˆä¸»æœºåã€å†…æ ¸ã€æ“ä½œç³»ç»Ÿï¼‰		
ss -tunlp		# æŸ¥çœ‹ç«¯å£å·ç›‘å¬çŠ¶æ€
```

##### è¾…åŠ©å‘½ä»¤

```powershell
è§£é‡Šseq
seq [èµ·å§‹å€¼] [æ­¥é•¿] [ç»ˆæ­¢å€¼]
seq 5
ğŸ‘‰ è¾“å‡º 1 2 3 4 5
seq 3 7
ğŸ‘‰ è¾“å‡º 3 4 5 6 7
seq 2 2 10
ğŸ‘‰ è¾“å‡º 2 4 6 8 10

xargs
xargs å‘½ä»¤å‚æ•°ä¼ é€’ï¼›
	ä¸execå‘½ä»¤ç›¸ä¼¼ï¼›-exec <å‘½ä»¤> {} +

ls .log | xargs wc -l					# å¿«é€Ÿç»Ÿè®¡æ‰€æœ‰ .log æ–‡ä»¶çš„è¡Œæ•°ã€‚
ls .txt | xargs -n 1 gzip				# -n 1 è¡¨ç¤ºæ¯æ¬¡åªä¼ é€’ä¸€ä¸ªæ–‡ä»¶ç»™ gzipï¼Œé€ä¸ªå‹ç¼©ã€‚
cat urls.txt | xargs -n 1 -P 4 curl -O	# ä» urls.txt ä¸‹è½½æ–‡ä»¶ï¼ŒåŒæ—¶å¼€ 4 ä¸ªå¹¶è¡Œä»»åŠ¡ï¼Œæ¯”å•çº¿ç¨‹å¿«å¾ˆå¤šã€‚

systemctl daemon-reload		
# åœ¨ä¿®æ”¹æˆ–æ·»åŠ  systemd å•å…ƒæ–‡ä»¶åï¼Œè®© systemd é‡æ–°è¯»å–å’Œåº”ç”¨æ–°çš„é…ç½®
```

##### kill -9

> è¯­æ³•ï¼škill [ä¿¡å·] PID
> ä¿¡å·ï¼šå‘Šè¯‰è¿›ç¨‹è¯¥åšä»€ä¹ˆï¼Œå¸¸è§æœ‰é€€å‡ºã€æŒ‚èµ·ã€é‡å¯ç­‰ã€‚
> 	-9 è¡¨ç¤ºå‘é€ SIGKILL ä¿¡å·ï¼ˆä¿¡å·ç¼–å· 9ï¼‰ã€‚
> 	â€¢ å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹ã€‚
> 	â€¢ å†…æ ¸ä¼šç«‹å³æ€æ­»è¿›ç¨‹ï¼Œé‡Šæ”¾èµ„æºã€‚



```

##### read

```powershell
è¯­æ³•ï¼šread [é€‰é¡¹] [å˜é‡å...]
-p "æç¤ºè¯­" â†’ æ˜¾ç¤ºæç¤º
-e â†’ å…è®¸ä½¿ç”¨æ–¹å‘é”®ã€é€€æ ¼ç¼–è¾‘è¾“å…¥ï¼ˆä¾èµ– readlineï¼‰
-t ç§’æ•° â†’ è®¾ç½®è¶…æ—¶
-s â†’ éšè—è¾“å…¥ï¼ˆå¸¸ç”¨äºè¾“å…¥å¯†ç ï¼‰
```



##### ä¸‰å‰‘å®¢	and	otherå‰‘å®¢

```powershell
sed '$a\Last line' file.txt					# åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸€è¡Œ
sed 's/foo/bar/g; s/baz/qux/g' file.txt		# ç”¨åˆ†å· `;` åˆ†éš”å¤šä¸ªå‘½ä»¤
	# å•å¼•å·ä¸ä¼šè§£æshellå˜é‡ï¼›
	# åŒå¼•å·å¯ä»¥è§£æshellå˜é‡ï¼›
	# /æ˜¯å®šç•Œç¬¦ï¼Œä¹Ÿå¯ä»¥æ˜¯@æˆ–è€…|æˆ–è€…#ç­‰ä»£æ›¿ã€‚
	# æ³¨æ„ -i ä¼šæ”¹æ–‡ä»¶ï¼Œ& å’Œ \1 æœ‰ç‰¹æ®Šæ„ä¹‰

awk '{print substr($0,4,5)}'				# æ²¡æœ‰åˆ—è¦æ±‚å°±$0,ç¬¬å››ä¸ªå­—ç¬¦å¼€å§‹å–äº”ä¸ªå­—ç¬¦è¾“å‡ºã€‚
awk '/error/ {print}' file.txt				# æ‰“å°åŒ…å« "error" çš„è¡Œ
awk -F'[ :]' '{print $1, $3}' file.txt		# ä½¿ç”¨å¤šä¸ªåˆ†éš”ç¬¦ï¼ˆè¿™é‡Œæ˜¯ç©ºæ ¼æˆ–å†’å·ï¼‰

grep -Ev  "^#|^$"				# ä¸è§£é‡Š
grep -nir "10.0.0.20" /etc/	# ä¸è§£é‡Š
grep  -o 'eth0'					# è¾“å‡ºè¿‡æ»¤çš„å†…å®¹ï¼Œè¿™ä¸ªæŒ‡ä»¤è¾“å‡ºæˆåŠŸåˆ™æ˜¯eth0

find . -name "file"				# å½“å‰ç›®å½•ä¸‹ä»¥"file"å¼€å¤´çš„æ–‡ä»¶ï¼›
find /home -iname ".txt"			# ä¸åŒºåˆ†å¤§å°å†™æŸ¥æ‰¾/homeç›®å½•ä¸‹æ‰€æœ‰.txtæ–‡ä»¶ï¼›
find /tmp -size +50M -size -100M	# æŸ¥æ‰¾50MBåˆ°100MBä¹‹é—´çš„æ–‡ä»¶ï¼›

 cut -c 3-6						# è¡¨ç¤ºæå–ä»ç¬¬ 3 ä¸ªå­—ç¬¦åˆ°ç¬¬ 6 ä¸ªå­—ç¬¦ã€‚
```

##### æ­£åˆ™è¡¨è¾¾å¼

```powershell
å‰è¨€ï¼š
	åŸºæœ¬æ­£åˆ™ (BRE) 	 æ‰©å±•æ­£åˆ™ (ERE)

åŸºæœ¬åŒ¹é…:
&&		# é€»è¾‘ä¸è¿ç®—ç¬¦ï¼Œè¡¨ç¤ºå‰ä¸€ä¸ªå‘½ä»¤æˆåŠŸåæ‰æ‰§è¡Œåä¸€ä¸ªå‘½ä»¤ã€‚
.		# åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦ï¼‰
[abc]	# åŒ¹é…aã€bæˆ–cä¸­çš„ä»»æ„ä¸€ä¸ª
[^abc]	# åŒ¹é…éaã€bã€cçš„å­—ç¬¦
é‡è¯ï¼ˆé‡å¤åŒ¹é…ï¼‰:
	# åŒ¹é…0æ¬¡æˆ–å¤šæ¬¡
+	# åŒ¹é…1æ¬¡æˆ–å¤šæ¬¡
?	# åŒ¹é…0æ¬¡æˆ–1æ¬¡
{n,m}	# åŒ¹é…nåˆ°mæ¬¡
ä½ç½®é”šç‚¹:
^	# åŒ¹é…è¡Œé¦–
$	# åŒ¹é…è¡Œå°¾
\b	# åŒ¹é…å­—ç¬¦ä¸²è¾¹ç•Œ
åˆ†ç»„ç¤ºä¾‹ï¼š
grep -E '^(cat|dog|fish)$' animals.txt		# åŒ¹é…è¡Œå†…å®¹ä¸º cat æˆ– dog æˆ– fishã€‚
# grep é»˜è®¤æ˜¯ BREï¼Œåˆ†ç»„è¦å†™æˆ \(...\)
# grep -Eï¼ˆegrepï¼‰ã€sed -E å°±æ˜¯ EREï¼Œåˆ†ç»„ç›´æ¥å†™ ( )
```

##### DNS

```powershell
Rocky9ç³»ç»Ÿï¼Œéœ€è¦å•ç‹¬å®‰è£…æœåŠ¡
[root@rocky9 ~]# yum install -y systemd-resolved
[root@rocky9 ~]# systemctl start systemd-resolved
æŸ¥çœ‹DNSé…ç½®ï¼š
	cat /etc/resolv.conf
æŸ¥çœ‹DNSæœåŠ¡çŠ¶æ€ï¼š
	resolvectl status
```

##### Apache

> â€‹	Apache2 çš„é…ç½®ä¸»è¦åˆ†ä¸ºä¸‰éƒ¨ä»½ï¼Œåˆ†åˆ«æ˜¯å…¨å±€é…ç½®ï¼Œè™šæ‹Ÿä¸»æœºé…ç½®ï¼Œæ¨¡å—é…ç½®ï¼Œè¿™äº›é…ç½®é¡¹åˆ†æ•£åœ¨ä¸åŒçš„ç›®å½•å’Œæ–‡ä»¶ä¸­ï¼Œåœ¨ä¸»é…ç½®æ–‡ä»¶ä¸­ä»¥æ–‡ä»¶åŒ…å«çš„å½¢å¼å¼•ç”¨å®ƒä»¬

```powershell
è½¯ä»¶å®‰è£…
apt install apache2 -y	|	yum install httpd -y
è¯­æ³•æ£€æµ‹
apachevtl -t
Rockyç³»ç»Ÿä¿®æ”¹é…ç½®
grep '#ServerName' /etc/httpd/conf/httpd.conf
sed -i "s@#ServerName@ServerName@" /etc/httpd/conf/httpd.conf
Ubuntuç³»ç»Ÿä¿®æ”¹é…ç½®
grep '#ServerName' /etc/apache2/sites-enabled/000-default.conf
sed -i '/#ServerRoot/ServerName www.example.com' /etc/apache2/apache2.conf

å®šåˆ¶æ—¥å¿—é£æ ¼ï¼š
åœ¨ apache2.confä¸­æ·»åŠ LogFçš„æ ¼å¼
grep -n  LogF  apache2.conf 
åœ¨/etc/apache2/sites-enabled/000-default.conf æ–‡ä»¶ä¸­ä¿®æ”¹ CustomLog ${APACHE_LOG_DIR}/access.logåé¢çš„combined æ”¹æˆè‡ªå·±æ–°æ·»åŠ LogFæ—¥å¿—çš„åå­—

è™šæ‹Ÿä¸»æœºï¼š
åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šé…ç½®å¤šä¸ªç«™ç‚¹ï¼ŒåŸºäºä¸åŒçš„ç«¯å£æ ‡è¯†ä¸åŒçš„è™šæ‹Ÿä¸»æœºã€‚
åœ¨/etc/apache2/sites-enabledæ–‡ä»¶ç›®å½•ä¸­åˆ›å»ºvhost.confæ–‡ä»¶ã€‚
æ–‡ä»¶å†…å®¹ï¼šç•¥

```

##### åˆ›å»ºCAè¯ä¹¦

```powershell
mkdir -p /etc/pki/CA/{certs,crl,newcerts,private}
touch /etc/pki/CA/index.txt
echo 01 > /etc/pki/CA/serial

openssl genrsa -out /etc/pki/CA/private/ca.key 2048	# ç”Ÿæˆç§é’¥ï¼›
openssl req -new -x509 -key /etc/pki/CA/private/ca.key -out /etc/pki/CA/cakey.pem -days 3650										# ç”Ÿæˆè‡ªç­¾åçš„CAæ ¹è¯ä¹¦

å®¢æˆ·ç«¯ï¼š
openssl genrsa -out tom.key 2048			# ç”Ÿæˆ tom çš„ç§é’¥
openssl req -new -key tom.key -out tom.csr	# ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚ (CSR)
scp tom.csr root@10.0.0.10:/tmp/			# å°† CSR æ–‡ä»¶æ‹·è´åˆ°æœåŠ¡å™¨ 10.0.0.10

æœåŠ¡å™¨ï¼š
cd /tmp
openssl ca -in tom.csr -out tom.crt -days 365	# ç”¨ CA ç»™ CSR ç­¾å‘è¯ä¹¦
scp tom.crt root@10.0.0.11:/home/tom/			# ç­¾å‘æˆåŠŸåï¼ŒæŠŠè¯ä¹¦æ‹·è´å›å®¢æˆ·ç«¯
scp /etc/pki/CA/cakey.pem root@10.0.0.11:/home/tom/

openssl verify -CAfile cakey.pem tom.crt		# å®¢æˆ·ç«¯æ£€æŸ¥è¯ä¹¦æ˜¯å¦ç”± CA ç­¾å‘

ca.crtä¸cakey.peméƒ½æ˜¯CAè¯ä¹¦æ–‡ä»¶ï¼Œåªæ˜¯åå­—ä¸åŒï¼›
csr è¯ä¹¦ç­¾å‘è¯·æ±‚ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç”³è¯·ä¹¦æ–‡ä»¶ï¼›
crt å¯ä»¥ç†è§£ä¸ºç”±CAç­¾å‘åï¼Œæ­£å¼ç”Ÿæ•ˆçš„è¯ä¹¦ï¼›

æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªç§é’¥æ–‡ä»¶.keyæ–‡ä»¶ï¼Œ
å†é€šè¿‡ç§é’¥ç”Ÿæˆ.csrç”³è¯·ä¹¦ï¼ˆå¸¦æœ‰å…¬é’¥+èº«ä»½ä¿¡æ¯ï¼‰å°†å®ƒäº¤ç»™CA,
CAç”¨è‡ªå·±çš„ç§é’¥ç­¾å‘ç»™ä½ ï¼Œç”Ÿæˆä¸€ä¸ªèº«ä»½è¯ï¼Œå³crtæ­£å¼ç”Ÿæ•ˆçš„è¯ä¹¦ã€‚
```





##### Linuxå¯åŠ¨æµç¨‹å’Œå†…æ ¸ç®¡ç†

###### æœåŠ¡ç®¡ç†

```powershell
å¯åŠ¨/åœæ­¢æœåŠ¡:
	systemctl start name1.service	|	systemctl stop name1.service
é‡å¯æœåŠ¡
	systemctl restart name.service
æŸ¥çœ‹çŠ¶æ€
	systemctl status name.service
ç¦æ­¢/å…è®¸æœåŠ¡å¯åŠ¨ã€å¼ºåˆ¶ç¦æ­¢çº§åˆ«ï¼Œstartæ— ç”¨ï¼Œå³å½»åº•ç¦æ­¢å¯åŠ¨ï¼ˆæ— è®ºæ‰‹åŠ¨è¿˜æ˜¯å¼€æœºè‡ªå¯ï¼‰ã€‘ã€‚
	systemctl mask name.service		|	systemctl unmask name.service
ç¦æ­¢/å…è®¸å¼€æœºè‡ªå¯ï¼š
	systemctl disable name.service	|	systemctl enable name.service
```

###### ä¿®æ”¹å†…æ ¸å‚æ•°

```powershell
ä¸´æ—¶ä¿®æ”¹ï¼š
    [root@rocky9 ~]# echo 123 > /proc/sys/net/ipv4/ip_forward
    æˆ–è€…
    [root@rocky9 ~]# sysctl -w net.ipv4.ip_forward=1
æŸ¥çœ‹æŒ‡å®šé…ç½®
    [root@rocky9 ~]# sysctl net.ipv4.ip_forward
    net.ipv4.ip_forward = 123
å†™å…¥é…ç½®ï¼Œæ°¸ä¹…ä¿®æ”¹ï¼š
	vim /etc/sysctl.conf
	sysctl -p	# é‡æ–°åŠ è½½
```

###### å‚æ•°è®¾ç½®

```powershell
ç³»ç»Ÿåœ¨å¯åŠ¨æ—¶ï¼Œä¼šæŒ‰ä¸‹åˆ—é¡ºåºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œè¯»å–å‚æ•°å€¼
    /etc/sysctl.d/.conf
    /usr/lib/sysctl.d/.conf
    /lib/sysctl.d/.conf
    /etc/sysctl.conf
æŸ¥çœ‹æ‰€æœ‰å‚æ•°
	sysctl -a
æŸ¥çœ‹æŒ‡å®šé¡¹
	sysctl net.ipv4.ip_forward

```

###### åˆ‡æ¢å¯åŠ¨æ¨¡å¼

```powershell
æŸ¥çœ‹çº§åˆ«ï¼š
    [root@rocky9 ~]# who -r
    è¿è¡Œçº§åˆ« 5 2024-10-11 18:26
    [root@rocky9 ~]# runlevel
    N 5
ä¸´æ—¶è®¾ç½®ï¼šç•¥
æ ‡å‡†è®¾ç½®ï¼š
	[root@rocky9 ~]# systemctl set-default multi-user.target
# åœ¨ systemd ä½“ç³»é‡Œï¼Œtarget ç›¸å½“äºä»¥å‰ SysV çš„â€œè¿è¡Œçº§åˆ«(runlevel)â€ã€‚
# graphical.target â‰ˆ è¿è¡Œçº§åˆ« 5ï¼ˆå¸¦å›¾å½¢ç•Œé¢ï¼‰
# multi-user.target â‰ˆ è¿è¡Œçº§åˆ« 3ï¼ˆçº¯å‘½ä»¤è¡Œï¼Œå¤šç”¨æˆ·ï¼‰
# systemctl isolate multi-user.target ç«‹å³åˆ‡æ¢åˆ°å‘½ä»¤è¡Œæ¨¡å¼ï¼Œè€Œä¸é‡å¯
```

